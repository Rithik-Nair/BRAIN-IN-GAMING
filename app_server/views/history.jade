html(lang="en")
  head
    meta(charset="UTF-8")
    meta(name="viewport", content="width=device-width, initial-scale=1.0")
    title= title
    script(src="https://cdn.jsdelivr.net/npm/chart.js")
    link(rel="stylesheet", href="/stylesheets/history.css")
  body
    h1= title

    .summary
      h3 Summary of BCI Usage
      p Total Games: #{totalGames}
      p Average BCI Usage: #{avgUsage}%
      p Maximum BCI Usage: #{maxUsage}%
      p Minimum BCI Usage: #{minUsage}%

    if history.length === 0
      p No game history available.
    else
      each game in history
        .history-entry
          h3= game.gameName
          p BCI Usage: #{game.bciUsage}%

          // Line Graph
          canvas(id="line-chart-#{game._id}", width="400", height="200")
          script.
            const lineCtx = document.getElementById('line-chart-#{game._id}').getContext('2d');
            new Chart(lineCtx, {
              type: 'line',
              data: {
                labels: #{JSON.stringify(game.analysisData.labels)},
                datasets: [{
                  label: 'BCI Usage',
                  data: #{JSON.stringify(game.analysisData.data)},
                  borderColor: 'rgba(75, 192, 192, 1)',
                  borderWidth: 1
                }]
              },
              options: {
                scales: {
                  y: { beginAtZero: true }
                }
              }
            });

          // Bar Graph
          canvas(id="bar-chart-#{game._id}", width="400", height="200")
          script.
            const barCtx = document.getElementById('bar-chart-#{game._id}').getContext('2d');
            new Chart(barCtx, {
              type: 'bar',
              data: {
                labels: #{JSON.stringify(game.analysisData.labels)},
                datasets: [{
                  label: 'BCI Usage',
                  data: #{JSON.stringify(game.analysisData.data)},
                  backgroundColor: 'rgba(75, 192, 192, 0.2)',
                  borderColor: 'rgba(75, 192, 192, 1)',
                  borderWidth: 1
                }]
              },
              options: {
                scales: {
                  y: { beginAtZero: true }
                }
              }
            });

          // Pie Chart
          canvas(id="pie-chart-#{game._id}", width="400", height="200")
          script.
            const pieCtx = document.getElementById('pie-chart-#{game._id}').getContext('2d');
            new Chart(pieCtx, {
              type: 'pie',
              data: {
                labels: ['Low Activity', 'Medium Activity', 'High Activity'],
                datasets: [{
                  data: #{JSON.stringify(game.analysisData.data)},
                  backgroundColor: ['rgba(75, 192, 192, 0.2)', 'rgba(153, 102, 255, 0.2)', 'rgba(255, 159, 64, 0.2)'],
                  borderColor: ['rgba(75, 192, 192, 1)', 'rgba(153, 102, 255, 1)', 'rgba(255, 159, 64, 1)'],
                  borderWidth: 1
                }]
              },
              options: {
                responsive: true
              }
            });

          // Histogram (Bar Chart representation of activity levels)
          canvas(id="histogram-#{game._id}", width="400", height="200")
          script.
            const histCtx = document.getElementById('histogram-#{game._id}').getContext('2d');
            new Chart(histCtx, {
              type: 'bar',
              data: {
                labels: ['0-20%', '21-40%', '41-60%', '61-80%', '81-100%'],
                datasets: [{
                  label: 'BCI Usage Distribution',
                  data: #{JSON.stringify(game.analysisData.data)},  // Activity level ranges
                  backgroundColor: 'rgba(75, 192, 192, 0.2)',
                  borderColor: 'rgba(75, 192, 192, 1)',
                  borderWidth: 1
                }]
              },
              options: {
                scales: {
                  y: { beginAtZero: true }
                }
              }
            });
